# https://locize.com/blog/next-app-dir-i18n/
name: people
type: magicservice
organisation: magicbutton
magicappversion: v0.0.1
description: |
  Application focusing on having a single point of entry in the form of a `person` to find all related information 
  - Users, Companies, Groups, Relations, Systems, Countries
baseattributes:
  record:
    &recordAttributes # Id + Created + Updated + CreatedBy + UpdatedBy are implicit
    - name: tenant
      type: string
      displayname: Tenant
      hidden: true
      required: true
    - name: searchindex
      type: string
      displayname: Search Index
      description: |
        Search Index is used for concatenating all searchable fields in a single field making in easier to search
      hidden: true
      required: true
    - name: name
      type: string
      displayname: Name
      required: true
    - name: description
      displayname: Description
      type: string
      required: false

entities:
  user: &user
    name: user
    displayname: User
    description: User
    baselineattributes: *recordAttributes
    additionalattributes:
      - name: fullname
        displayname: FullName
        type: string
        required: true
  incident: &incident
    name: incident
    additionalattributes:
      - name: reporter
        displayname: Reporter
        type: reference
        entity: *user
        required: true
  auditlog: &auditlog
    name: auditlog
    displayname: Audit Log
    description: Audit Log
    baselineattributes: *recordAttributes
    additionalattributes:
      - name: action
        type: string
        required: true
      - name: status
        type: string
        required: true
      - name: entity
        type: string
        required: true
      - name: entityid
        type: string
        required: true
      - name: actor
        type: string
        required: true
      - name: metadata
        type: json
        required: false
  usergroup: &usergroup
    name: usergroup
    displayname: User Group
    description: User Group
    baselineattributes: *recordAttributes
    additionalattributes:
      - name: members
        displayname: Members
        type: array
        entity: *user
        required: true
  schemas: &schemas
    name: schemas
    displayname: Schemas
    description: Schemas
    baselineattributes: *recordAttributes
    additionalattributes:
      - name: data
        displayname: Data
        type: json
        required: true

  service: &service
    name: service
    displayname: Service
    description: Service
    baselineattributes: *recordAttributes
    additionalattributes:
      - name: owner
        displayname: Owner
        type: reference
        entity: *user
        required: true
      - name: responsible
        displayname: Responsible
        type: reference
        entity: *user
        required: true
      - name: consulted
        displayname: Consulted
        type: reference
        entity: *usergroup
        required: false
      - name: informed
        displayname: Informed
        type: reference
        entity: *usergroup
        required: false
      # - name: status
      #   displayname: Status
      #   type: string
      #   required: true
      # - name: type
      #   displayname: Type
      #   type: string
      #   required: true
      - name: data
        displayname: Data
        type: json
        required: false
  serviceinstance: &serviceinstance
    name: serviceinstance
    displayname: Service Instance
    description: Service Instance
    baselineattributes: *recordAttributes
    additionalattributes:
      - name: service
        displayname: Service
        type: reference
        entity: *service
        required: true
      - name: owner
        displayname: Owner
        type: reference
        entity: *user
        required: true
      - name: responsible
        displayname: Responsible
        type: reference
        entity: *user
        required: true
      - name: consulted
        displayname: Consulted
        type: reference
        entity: *usergroup
        required: false
      - name: informed
        displayname: Informed
        type: reference
        entity: *usergroup
        required: false
      - name: data
        displayname: Data
        type: json
        required: false
models:
  itemMethods: &itemMethods
    - name: read
      description: Read a single item
      parameters:
        - name: id
          description: The id of the item
          type: int64
          required: true
      returns:
        type: object

    - name: create
      description: Create a new item
      parameters:
        - name: item
          description: The item to create
          type: object
          required: true
      returns:
        type: object
    - name: update
      description: Update an existing item
      parameters:
        - name: item
          description: The item to update
          type: object
          required: true
      returns:
        type: object

    - name: delete
      description: Delete an existing item
      parameters:
        - name: id
          description: The id of the item
          type: int64
          required: true
      returns:
        type: void
    - name: search
      description: Search for items
      parameters:
        - name: query
          description: The search query
          type: string
          required: true

      returns:
        type: page

services:
  - name: user
    description: Manage users
    entity:
      type: record
      model: user
      objectname: User
      entity: *user
    methods: *itemMethods

  - name: incident
    description: Manage incident
    entity:
      type: record
      model: incident
      objectname: Incident
      entity: *incident
    methods: *itemMethods

  - name: auditlog
    description: Manage audit logs
    entity:
      type: auditlog
      model: auditlog
      objectname: AuditLog
      entity: *auditlog
    methods: *itemMethods

  - name: service
    description: Manage services
    entity:
      type: record
      model: service
      objectname: Service
      entity: *service
    methods: *itemMethods

  - name: schemas
    description: Manage schemas
    entity:
      type: record
      model: schemas
      objectname: Schemas
      entity: *schemas
    methods: *itemMethods

  - name: serviceinstance
    description: Manage service instances
    entity:
      type: record
      model: serviceinstance
      objectname: ServiceInstance
      entity: *serviceinstance
    methods: *itemMethods
